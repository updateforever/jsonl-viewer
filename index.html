<input type="file" id="uploadJson" accept=".json">
<div class="container" id="dataContainer"></div>

<script>
    document.getElementById('uploadJson').addEventListener('change', function (event) {
        const file = event.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function (e) {
            try {
                const jsonData = JSON.parse(e.target.result);

                // 设置抽取的数据条数
                const sampleSize = 50;
                const sampledData = jsonData.length > sampleSize ? getRandomSample(jsonData, sampleSize) : jsonData;

                // 解析并展示 JSON 数据
                const container = document.getElementById("dataContainer");
                container.innerHTML = ''; // 清空旧数据
                sampledData.forEach(entry => {
                    const div = document.createElement("div");
                    div.className = "entry";
                    div.innerHTML = `
                    <h3>ID: ${entry.id}</h3>
                    <p><strong>Mastery Level:</strong> ${entry.mastery_level}</p>
                    <p><strong>Question Type:</strong> ${entry.question_type}</p>
                    <p><strong>Knowledge:</strong> ${entry.knowledge}</p>
                    <p><strong>Messages:</strong></p>
                    <ul>
                        ${entry.messages.map(msg => `<li><strong>${msg.role}:</strong> ${msg.content}</li>`).join('')}
                    </ul>
                `;
                    container.appendChild(div);
                });
            } catch (error) {
                alert("JSON 文件格式错误，请检查后再上传！");
            }
        };
        reader.readAsText(file);
    });

    // 随机抽取 N 条数据
    function getRandomSample(array, sampleSize) {
        let shuffled = array.sort(() => 0.5 - Math.random());
        return shuffled.slice(0, sampleSize);
    }
</script>